# å¹²çªçœ¼æ¸¸æˆé¡¹ç›®å¼€å‘è§„èŒƒ

## ğŸ¯ é¡¹ç›®æ¦‚è¿°
å¹²çªçœ¼æ˜¯ä¸€ä¸ªåŸºäº React + TypeScript + Socket.io çš„å®æ—¶å¤šäººå¡ç‰Œæ¸¸æˆï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ã€‚

## ğŸ“‹ é¡¹ç›®ç®¡ç†è§„èŒƒ

### æ–‡ä»¶ç»„ç»‡ç»“æ„
```
gan_deng_yan/
â”œâ”€â”€ client/                 # Reactå‰ç«¯ (ç«¯å£5173)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # Reactç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ GameBoard.tsx   # æ¸¸æˆä¸»ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ TurnTimer.tsx   # è½®æ¬¡è®¡æ—¶å™¨
â”‚   â”‚   â”‚   â””â”€â”€ VictoryEffect.tsx # èƒœåˆ©ç‰¹æ•ˆ
â”‚   â”‚   â”œâ”€â”€ hooks/         # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”‚   â””â”€â”€ useSocket.ts    # Socketè¿æ¥ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ cardUtils.ts    # å¡ç‰Œå·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ uiUtils.ts      # UIå·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ types/         # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â””â”€â”€ game.ts         # æ¸¸æˆç›¸å…³ç±»å‹
â”‚   â”‚   â”œâ”€â”€ App.tsx        # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ main.tsx       # åº”ç”¨å…¥å£
â”‚   â”‚   â””â”€â”€ App.css        # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ server/                 # Node.jsåç«¯ (ç«¯å£3001)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ models/        # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ Card.ts         # å¡ç‰Œæ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ Game.ts         # æ¸¸æˆæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ server.ts      # æœåŠ¡å™¨å…¥å£
â”‚   â”‚   â””â”€â”€ socket/        # WebSocketå¤„ç† (å†…åµŒåœ¨server.tsä¸­)
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ docs/                   # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ gan_deng_yan_rules.md      # æ¸¸æˆè§„åˆ™
â”‚   â”œâ”€â”€ gan_deng_yan_dev_doc.md    # å¼€å‘æ–‡æ¡£
â”‚   â”œâ”€â”€ gan_deng_yan_ui_ux_roadmap.md # UI/UXè·¯çº¿å›¾
â”‚   â”œâ”€â”€ GAN_DENG_YAN_MULTIPLAYER_ROADMAP.md # å¤šäººæ¨¡å¼è·¯çº¿å›¾
â”‚   â”œâ”€â”€ BUGFIX_REPORT.md     # Bugä¿®å¤æŠ¥å‘Š
â”‚   â”œâ”€â”€ PHASE1_ENHANCEMENTS.md # Phase 1 å¢å¼ºæŠ¥å‘Š
â”‚   â”œâ”€â”€ PHASE2_ENHANCEMENTS.md # Phase 2 å¢å¼ºæŠ¥å‘Š
â”‚   â””â”€â”€ PHASE3_ENHANCEMENTS.md # Phase 3 å¢å¼ºæŠ¥å‘Š
â”œâ”€â”€ package.json           # æ ¹ç›®å½•é…ç½®
â”œâ”€â”€ railway.toml          # Railwayéƒ¨ç½²é…ç½®
â”œâ”€â”€ .gitignore           # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .cursorrules         # å¼€å‘è§„èŒƒ
â”œâ”€â”€ README.md            # é¡¹ç›®è¯´æ˜
â””â”€â”€ LICENSE              # å¼€æºè®¸å¯è¯
```

### å‘½åè§„èŒƒ
- **æ–‡ä»¶å‘½å**: ä½¿ç”¨ PascalCase (ç»„ä»¶) æˆ– camelCase (å·¥å…·å‡½æ•°)
- **ç»„ä»¶å‘½å**: PascalCaseï¼Œå¦‚ `GameBoard.tsx`
- **å‡½æ•°å‘½å**: camelCaseï¼Œå¦‚ `handleCardClick`
- **å¸¸é‡å‘½å**: UPPER_SNAKE_CASEï¼Œå¦‚ `MAX_PLAYERS`
- **ç±»å‹å‘½å**: PascalCaseï¼Œå¦‚ `GameState`

### ç‰ˆæœ¬æ§åˆ¶
- æäº¤ä¿¡æ¯æ ¼å¼: `type(scope): description`
- ç±»å‹: feat, fix, docs, style, refactor, test, chore
- ç¤ºä¾‹: `feat(game): add wildcard straight support`

### æäº¤è§„èŒƒ
- **ALWAYS** ä½¿ç”¨ä¸­æ–‡æè¿°æäº¤ä¿¡æ¯ï¼Œæ ¼å¼ï¼š`feat/fix/docs: åŠŸèƒ½æè¿°`
- **ALWAYS** åŒ…å«è¯¦ç»†çš„åŠŸèƒ½ç‚¹åˆ—è¡¨
- **ALWAYS** æäº¤å‰è¿è¡Œ `npm run build` ç¡®ä¿æ„å»ºæˆåŠŸ
- **ALWAYS** æäº¤ä¿¡æ¯åŒ…å«ï¼šä¸»è¦åŠŸèƒ½ã€ä¿®å¤é—®é¢˜ã€æ›´æ–°å†…å®¹
- **ALWAYS** åœ¨æäº¤å‰ç¡®è®¤æ²¡æœ‰é—ç•™çš„ä¸´æ—¶æ–‡ä»¶æˆ–è°ƒè¯•ä»£ç 
- **ALWAYS** åœ¨æäº¤å‰åœ¨ç›¸å…³æ–‡æ¡£çš„åšåˆç†çš„æ›´æ–°

### Gitæäº¤æ ‡å‡†æµç¨‹
- **WHEN** ç”¨æˆ·è¯´"commitåˆ°github"æˆ–ç±»ä¼¼è¡¨è¿° â†’ **MUST** æ‰§è¡Œå®Œæ•´æäº¤æµç¨‹ï¼š
  1. **æ£€æŸ¥å·¥ä½œç›®å½•** â†’ ç¡®è®¤åœ¨ `/gan_deng_yan` ç›®å½•
  2. **æ„å»ºéªŒè¯** â†’ è¿è¡Œ `npm run build` ç¡®ä¿æ— é”™è¯¯
  3. **æ–‡æ¡£æ›´æ–°** â†’ æ£€æŸ¥å¹¶æ›´æ–°ç›¸å…³docsæ–‡ä»¶çš„å®ŒæˆçŠ¶æ€
  4. **ä»£ç æ£€æŸ¥** â†’ è¿è¡Œ `git status` æŸ¥çœ‹å˜æ›´æ–‡ä»¶
  5. **æš‚å­˜æ–‡ä»¶** â†’ `git add .` æ·»åŠ æ‰€æœ‰å˜æ›´
  6. **è§„èŒƒæäº¤** â†’ ä½¿ç”¨æ ‡å‡†commitæ ¼å¼å’Œè¯¦ç»†æè¿°
  7. **æ¨é€ä»£ç ** â†’ `git push origin main`

## ğŸ›¡ï¸ é”™è¯¯é¢„é˜²è§„åˆ™

### TypeScript ä¸¥æ ¼æ¨¡å¼
- å¯ç”¨æ‰€æœ‰ä¸¥æ ¼æ£€æŸ¥é€‰é¡¹
- ç¦æ­¢ä½¿ç”¨ `any` ç±»å‹ï¼Œå¿…é¡»æ˜ç¡®ç±»å‹å®šä¹‰
- ä½¿ç”¨æ³›å‹æé«˜ä»£ç å¤ç”¨æ€§
- æ‰€æœ‰å‡½æ•°å¿…é¡»æœ‰æ˜ç¡®çš„è¿”å›ç±»å‹

### å‰åç«¯ä¸€è‡´æ€§æ£€æŸ¥
- ç‰Œå‹è¯†åˆ«é€»è¾‘å¿…é¡»å‰åç«¯å®Œå…¨ä¸€è‡´
- ä½¿ç”¨å…±äº«çš„ç±»å‹å®šä¹‰æ–‡ä»¶
- å®šæœŸè¿è¡Œä¸€è‡´æ€§æµ‹è¯•
- ä»»ä½•ç‰Œå‹é€»è¾‘ä¿®æ”¹å¿…é¡»åŒæ—¶æ›´æ–°å‰åç«¯
- **ALWAYS** ä¿®æ”¹ç‰Œå‹é€»è¾‘æ—¶åŒæ—¶æ›´æ–° `client/src/utils/cardUtils.ts` å’Œ `server/src/models/Card.ts`
- **ALWAYS** åœ¨ä¿®æ”¹åæµ‹è¯•å‰åç«¯ç‰Œå‹è¯†åˆ«ç»“æœæ˜¯å¦ä¸€è‡´
- **WHEN** å‘ç°å‰åç«¯ä¸ä¸€è‡´ â†’ **MUST** ç«‹å³ä¿®å¤å¹¶è®°å½•åˆ° `docs/BUGFIX_REPORT.md`

### è¿è¡Œæ—¶é”™è¯¯é¢„é˜²
```typescript
// âœ… æ­£ç¡®çš„é”™è¯¯å¤„ç†
const handleCardClick = (card: Card) => {
  if (!card || !gameState) {
    console.warn('Invalid card or game state');
    return;
  }
  // å¤„ç†é€»è¾‘
};

// âŒ é¿å…ç›´æ¥è®¿é—®å¯èƒ½ä¸ºç©ºçš„å±æ€§
const handleCardClick = (card: Card) => {
  gameState.players[0].cards.push(card); // å¯èƒ½å‡ºé”™
};
```

### ç½‘ç»œé”™è¯¯å¤„ç†
- WebSocket è¿æ¥æ–­å¼€è‡ªåŠ¨é‡è¿
- è¯·æ±‚è¶…æ—¶å¤„ç†
- ä¼˜é›…çš„é”™è¯¯æç¤º
- ç¦»çº¿çŠ¶æ€æ£€æµ‹

### é”™è¯¯è®°å½•è§„åˆ™
- **ALWAYS** å°†æ–°å‘ç°çš„é‡è¦Bugæ·»åŠ åˆ° `docs/BUGFIX_REPORT.md`
- **WHEN** åŒç±»é”™è¯¯å‡ºç°3æ¬¡ä»¥ä¸Š â†’ **MUST** æ·»åŠ é¢„é˜²è§„åˆ™åˆ° `.cursorrules`
- **ALWAYS** åœ¨é”™è¯¯ä¿®å¤åè€ƒè™‘æ˜¯å¦éœ€è¦æ·»åŠ é¢„é˜²è§„åˆ™
- **ALWAYS** è®°å½•é”™è¯¯çš„å…·ä½“åœºæ™¯ã€å¤ç°æ­¥éª¤å’Œè§£å†³æ–¹æ¡ˆ
- **ALWAYS** æ›´æ–°ç›¸å…³æ–‡æ¡£ä¸­çš„å·²çŸ¥é—®é¢˜åˆ—è¡¨

## ğŸ¨ UI/UX è®¾è®¡è§„èŒƒ

### è®¾è®¡åŸåˆ™
1. **ç§»åŠ¨ä¼˜å…ˆ**: æ‰€æœ‰è®¾è®¡é¦–å…ˆè€ƒè™‘ç§»åŠ¨ç«¯ä½“éªŒ
2. **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„è§†è§‰è¯­è¨€å’Œäº¤äº’æ¨¡å¼
3. **å¯è®¿é—®æ€§**: æ”¯æŒé”®ç›˜å¯¼èˆªå’Œå±å¹•é˜…è¯»å™¨
4. **æ€§èƒ½ä¼˜å…ˆ**: æµç•…çš„60fpsåŠ¨ç”»ä½“éªŒ

### é¢œè‰²ç³»ç»Ÿ
```css
/* ä¸»è‰²è°ƒ */
--primary-blue: #3B82F6;
--primary-purple: #8B5CF6;
--success-green: #10B981;
--warning-orange: #F59E0B;
--danger-red: #EF4444;

/* èƒŒæ™¯æ¸å˜ */
--gradient-primary: linear-gradient(-45deg, #90caf9, #ce93d8, #a5d6a7, #ffcc02);
--gradient-glass: rgba(0, 0, 0, 0.55);

/* ç‰Œå‹é¢œè‰²ç¼–ç  */
--card-single: #3B82F6;    /* è“è‰² - å•å¼  */
--card-pair: #3B82F6;      /* è“è‰² - å¯¹å­ */
--card-straight: #10B981;  /* ç»¿è‰² - é¡ºå­ */
--card-triple: #F59E0B;    /* æ©™è‰² - ä¸‰å¼ ç‚¸å¼¹ */
--card-quadruple: #EF4444; /* çº¢è‰² - å››å¼ ç‚¸å¼¹ */
--card-joker-bomb: #8B5CF6; /* ç´«è‰² - ç‹ç‚¸ */
```

### ç»„ä»¶è®¾è®¡è§„èŒƒ
- **å¡ç‰Œç»„ä»¶**: 3.5rem Ã— 5remï¼Œåœ†è§’12pxï¼Œ3Dæ•ˆæœ
- **æŒ‰é’®ç»„ä»¶**: ç»Ÿä¸€ä½¿ç”¨ `btn-enhanced` ç±»ï¼Œæ”¯æŒrippleæ•ˆæœ
- **é¢æ¿ç»„ä»¶**: æ¯›ç»ç’ƒæ•ˆæœï¼Œåœ†è§’16pxï¼Œbackdrop-blur
- **åŠ¨ç”»æ—¶é•¿**: å¿«é€Ÿåé¦ˆ80msï¼Œæ ‡å‡†åŠ¨ç”»300msï¼Œå¤æ‚åŠ¨ç”»800ms
- **ç‰¹æ®Šç‰Œæ ·å¼**: æ©™è‰²è¾¹æ¡† + æ˜Ÿæ˜Ÿæ ‡è®°ï¼ˆ2ã€å¤§å°ç‹ï¼‰
- **ç‚¸å¼¹æ•ˆæœ**: è„‰å†²åŠ¨ç”»ï¼Œçº¢è‰²æ¸å˜èƒŒæ™¯

### å“åº”å¼æ–­ç‚¹
```css
/* ç§»åŠ¨ç«¯: < 768px */
/* å¹³æ¿: 768px - 1024px */
/* æ¡Œé¢: > 1024px */
/* å¤§å±: > 1920px */
```

### åŠ¨ç”»è§„èŒƒ
- ä½¿ç”¨ CSS transform å’Œ opacity å®ç°ç¡¬ä»¶åŠ é€Ÿ
- ç¼“åŠ¨å‡½æ•°: `cubic-bezier(0.4, 0, 0.2, 1)`
- é¿å…åŒæ—¶è§¦å‘è¿‡å¤šåŠ¨ç”»
- æä¾› `prefers-reduced-motion` æ”¯æŒ

## ğŸ—ï¸ ä»£ç ç»“æ„è§„èŒƒ

### React ç»„ä»¶è§„èŒƒ
```typescript
// âœ… æ¨èçš„ç»„ä»¶ç»“æ„
interface ComponentProps {
  // æ˜ç¡®çš„ç±»å‹å®šä¹‰
}

const Component: React.FC<ComponentProps> = ({ prop1, prop2 }) => {
  // 1. Hooks
  const [state, setState] = useState();
  
  // 2. äº‹ä»¶å¤„ç†å‡½æ•°
  const handleClick = useCallback(() => {
    // å¤„ç†é€»è¾‘
  }, []);
  
  // 3. æ¸²æŸ“å‡½æ•°
  return (
    <div>
      {/* JSX */}
    </div>
  );
};

export default Component;
```

### è‡ªå®šä¹‰ Hooks è§„èŒƒ
```typescript
// âœ… æ¨èçš„ Hook ç»“æ„
export const useGameLogic = (gameState: GameState) => {
  // çŠ¶æ€ç®¡ç†
  const [localState, setLocalState] = useState();
  
  // å‰¯ä½œç”¨
  useEffect(() => {
    // å‰¯ä½œç”¨é€»è¾‘
  }, [gameState]);
  
  // è¿”å›å€¼å’Œå‡½æ•°
  return {
    state: localState,
    actions: {
      // æ“ä½œæ–¹æ³•
    }
  };
};
```

### å·¥å…·å‡½æ•°è§„èŒƒ
```typescript
// âœ… çº¯å‡½æ•°ï¼Œæ˜ç¡®çš„è¾“å…¥è¾“å‡º
export const calculateCardValue = (card: Card): number => {
  // å®ç°é€»è¾‘
  return value;
};

// âœ… å‰¯ä½œç”¨å‡½æ•°ï¼Œæ˜ç¡®æ ‡æ³¨
export const triggerAnimation = (element: HTMLElement): void => {
  // DOM æ“ä½œ
};
```

### ç±»å‹å®šä¹‰è§„èŒƒ
```typescript
// âœ… æ˜ç¡®çš„ç±»å‹å®šä¹‰
export interface GameState {
  gameId: string;
  players: Player[];
  currentPlayerIndex: number;
  lastPlay: CardPlay | null;
  phase: 'waiting' | 'playing' | 'finished';
  winner: string | null;
  lastWinner?: string | null;
  createdAt: number;
  deckCount?: number;
  discardPileCount?: number;
  maxPlayers?: number;
  consecutivePasses?: number;
  lastPlayerId?: string | null;
  turnStartTime?: number;
  turnTimeLimit?: number;
}

// âœ… ä½¿ç”¨æšä¸¾ç±»å‹
export enum CardType {
  SINGLE = 'single',
  PAIR = 'pair',
  STRAIGHT = 'straight',
  TRIPLE = 'triple',
  QUADRUPLE = 'quadruple',
  JOKER_BOMB = 'joker_bomb'
}

// âœ… è”åˆç±»å‹
export type Suit = 'hearts' | 'diamonds' | 'clubs' | 'spades' | 'joker';
export type Rank = '3' | '4' | '5' | '6' | '7' | '8' | '9' | '10' | 'J' | 'Q' | 'K' | 'A' | '2' | 'small_joker' | 'big_joker';

// âœ… æ³›å‹ç±»å‹
export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}
```

## ğŸ”„ å¼€å‘å·¥ä½œæµè§„èŒƒ

### å¼€å‘ç¯å¢ƒè®¾ç½®
1. **Node.js**: ç‰ˆæœ¬ 18+ 
2. **åŒ…ç®¡ç†å™¨**: npm
3. **ç¼–è¾‘å™¨**: VS Code + æ¨èæ‰©å±•
4. **Git**: ä½¿ç”¨ Git Flow å·¥ä½œæµ

### å¼€å‘å‘½ä»¤
```bash
# å®‰è£…ä¾èµ–
npm run install:all

# å¼€å‘æ¨¡å¼
npm run dev                    # åŒæ—¶å¯åŠ¨å‰åç«¯
npm run dev:client            # ä»…å¯åŠ¨å‰ç«¯ (ç«¯å£5173)
npm run dev:server            # ä»…å¯åŠ¨åç«¯ (ç«¯å£3001)

# æ„å»º
npm run build                 # æ„å»ºå‰åç«¯
npm run build:client          # ä»…æ„å»ºå‰ç«¯
npm run build:server          # ä»…æ„å»ºåç«¯

# ç±»å‹æ£€æŸ¥
npm run tsc                   # æ£€æŸ¥TypeScriptç±»å‹

# ä»£ç æ£€æŸ¥
npm run lint                  # ESLintæ£€æŸ¥

# ç”Ÿäº§å¯åŠ¨
npm start                     # å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
```

### å¼€å‘æµç¨‹è§„èŒƒ
- **ALWAYS** å¼€å‘æ–°åŠŸèƒ½å‰å…ˆè¿è¡Œ `npm run tsc` ç¡®ä¿æ— ç±»å‹é”™è¯¯
- **ALWAYS** æäº¤å‰è¿è¡Œ `npm run build` ç¡®ä¿æ„å»ºæˆåŠŸ
- **ALWAYS** ä¿®æ”¹åŠ¨ç”»æ•ˆæœåæµ‹è¯•ç§»åŠ¨ç«¯å…¼å®¹æ€§
- **WHEN** æ·»åŠ æ–°çš„ç‰Œå‹é€»è¾‘ â†’ **MUST** åŒæ—¶æ›´æ–°å‰åç«¯ä»£ç 
- **WHEN** ä¿®æ”¹UIç»„ä»¶ â†’ **MUST** æµ‹è¯•å“åº”å¼å¸ƒå±€
- **ALWAYS** åœ¨ `client/src/App.css` ä¸­æ·»åŠ æ–°åŠ¨ç”»æ—¶è€ƒè™‘æ€§èƒ½å½±å“

### ä»£ç è´¨é‡æ£€æŸ¥
- **ESLint**: å¼ºåˆ¶æ‰§è¡Œä»£ç è§„èŒƒ
- **Prettier**: ç»Ÿä¸€ä»£ç æ ¼å¼
- **TypeScript**: ç±»å‹å®‰å…¨æ£€æŸ¥
- **Husky**: Git hooks è‡ªåŠ¨æ£€æŸ¥

### æµ‹è¯•è§„èŒƒ
```typescript
// âœ… å•å…ƒæµ‹è¯•ç¤ºä¾‹
describe('CardUtils', () => {
  it('should identify single card correctly', () => {
    const card = createCard('A', 'hearts');
    const result = CardUtils.identifyCardType([card]);
    expect(result).toBe(CardType.SINGLE);
  });
  
  it('should identify wildcard pair correctly', () => {
    const cards = [createCard('K', 'hearts'), createCard('small_joker', 'joker')];
    const result = CardUtils.identifyCardType(cards);
    expect(result).toBe(CardType.PAIR);
  });
  
  it('should identify joker bomb correctly', () => {
    const cards = [createCard('small_joker', 'joker'), createCard('big_joker', 'joker')];
    const result = CardUtils.identifyCardType(cards);
    expect(result).toBe(CardType.JOKER_BOMB);
  });
});
```

### æµ‹è¯•æµç¨‹è§„èŒƒ
- **ALWAYS** æ·»åŠ æ–°çš„ç‰Œå‹é€»è¾‘æ—¶ç¼–å†™å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹
- **ALWAYS** æµ‹è¯•ç™¾æ­ç‰Œçš„å„ç§ç»„åˆæƒ…å†µ
- **ALWAYS** æµ‹è¯•å‰åç«¯ç‰Œå‹è¯†åˆ«çš„ä¸€è‡´æ€§
- **WHEN** ä¿®å¤Bug â†’ **MUST** æ·»åŠ å›å½’æµ‹è¯•ç”¨ä¾‹
- **ALWAYS** æµ‹è¯•åŠ¨ç”»æ•ˆæœåœ¨ä¸åŒæµè§ˆå™¨ä¸­çš„è¡¨ç°
- **ALWAYS** æµ‹è¯•WebSocketè¿æ¥æ–­å¼€é‡è¿åŠŸèƒ½

### æ€§èƒ½ä¼˜åŒ–è§„èŒƒ
- ä½¿ç”¨ React.memo ä¼˜åŒ–ç»„ä»¶é‡æ¸²æŸ“
- ä½¿ç”¨ useCallback å’Œ useMemo ç¼“å­˜å‡½æ•°å’Œå€¼
- é¿å…åœ¨æ¸²æŸ“å‡½æ•°ä¸­åˆ›å»ºæ–°å¯¹è±¡
- ä½¿ç”¨ React.lazy è¿›è¡Œä»£ç åˆ†å‰²

## ğŸ“Š åŠ¨æ€æ›´æ–°æœºåˆ¶

### çŠ¶æ€ç®¡ç†
```typescript
// âœ… ä½¿ç”¨ Context + useReducer ç®¡ç†å…¨å±€çŠ¶æ€
const GameContext = createContext<GameContextType | null>(null);

const gameReducer = (state: GameState, action: GameAction): GameState => {
  switch (action.type) {
    case 'UPDATE_GAME_STATE':
      return { ...state, ...action.payload };
    // å…¶ä»– action
  }
};
```

### WebSocket äº‹ä»¶å¤„ç†
```typescript
// âœ… ç»Ÿä¸€çš„äº‹ä»¶å¤„ç†æ¨¡å¼
const useSocketEvents = () => {
  useEffect(() => {
    socket.on('game-state', handleGameStateUpdate);
    socket.on('error', handleError);
    
    return () => {
      socket.off('game-state', handleGameStateUpdate);
      socket.off('error', handleError);
    };
  }, []);
};
```

### é”™è¯¯è¾¹ç•Œ
```typescript
// âœ… é”™è¯¯è¾¹ç•Œç»„ä»¶
class ErrorBoundary extends React.Component {
  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    console.error('Game error:', error, errorInfo);
    // é”™è¯¯ä¸ŠæŠ¥é€»è¾‘
  }
  
  render() {
    if (this.state.hasError) {
      return <ErrorFallback />;
    }
    return this.props.children;
  }
}
```

## ğŸ® æ¸¸æˆç‰¹å®šè§„èŒƒ

### ç‰Œå‹è¯†åˆ«è§„èŒƒ
- æ‰€æœ‰ç‰Œå‹è¯†åˆ«é€»è¾‘å¿…é¡»å‰åç«¯ä¸€è‡´ï¼ˆClientCardUtils vs CardUtilsï¼‰
- ç™¾æ­ç‰Œé€»è¾‘éœ€è¦ç‰¹æ®Šå¤„ç†ï¼ˆå¤§å°ç‹å¯æ›¿ä»£ä»»æ„ç‰Œï¼‰
- ç‚¸å¼¹ç‰Œå‹ä¼˜å…ˆçº§æ˜ç¡®ï¼ˆå››å¼  > ä¸‰å¼  > ç‹ç‚¸ï¼‰
- é¡ºå­è§„åˆ™ä¸¥æ ¼éµå¾ªï¼ˆä¸å«2ï¼Œæ”¯æŒç™¾æ­é¡ºå­ï¼‰
- ç‰¹æ®Šç‰Œè§„åˆ™ï¼ˆ2åªèƒ½è¢«å¤§å°ç‹æˆ–ç‚¸å¼¹å‹åˆ¶ï¼‰
- ç‹ç‚¸ä¼˜å…ˆè¯†åˆ«ï¼ˆå¤§ç‹+å°ç‹ä¼˜å…ˆè¯†åˆ«ä¸ºç‹ç‚¸è€Œéç™¾æ­å¯¹å­ï¼‰

### åŠ¨ç”»ç³»ç»Ÿè§„èŒƒ
```typescript
// âœ… åŠ¨ç”»å·¥å…·å‡½æ•°è§„èŒƒ
export const triggerCardAnimation = (
  element: HTMLElement,
  animationType: 'select' | 'play' | 'deal' | 'flip' | 'victory'
): void => {
  // åŠ¨ç”»é€»è¾‘
  switch (animationType) {
    case 'select':
      element.classList.add('card-quick-select-instant');
      setTimeout(() => element.classList.remove('card-quick-select-instant'), 60);
      break;
    case 'play':
      element.classList.add('card-fly-out');
      break;
    case 'deal':
      element.classList.add('card-dealing');
      setTimeout(() => element.classList.remove('card-dealing'), 800);
      break;
    case 'flip':
      element.classList.add('card-flip');
      setTimeout(() => element.classList.remove('card-flip'), 600);
      break;
    case 'victory':
      element.classList.add('victory-card');
      break;
  }
};

// âœ… å¤æ‚åŠ¨ç”»ç»„åˆ
export const triggerPlayCardCombo = (element: HTMLElement): void => {
  triggerCardWobble(element);
  setTimeout(() => createParticleExplosion(element, 15), 200);
  setTimeout(() => triggerCardFlyToCenter(element), 400);
};
```

### å¤šäººæ¸¸æˆè§„èŒƒ
- æ”¯æŒ2-6äººæ¸¸æˆï¼ˆå½“å‰å·²å®ç°2äººï¼Œå¤šäººæ¨¡å¼åœ¨è·¯çº¿å›¾ä¸­ï¼‰
- æˆ¿é—´ç³»ç»Ÿè®¾è®¡ï¼ˆå·²å®ç°åŸºç¡€åŒ¹é…ï¼‰
- æ–­çº¿é‡è¿æœºåˆ¶ï¼ˆWebSocketè‡ªåŠ¨é‡è¿ï¼‰
- è§‚æˆ˜æ¨¡å¼æ”¯æŒï¼ˆè®¡åˆ’åŠŸèƒ½ï¼‰
- è½®æ¬¡è¶…æ—¶å¤„ç†ï¼ˆå·²å®ç°20ç§’è¶…æ—¶ï¼‰
- å†ç©ä¸€æ¬¡åŠŸèƒ½ï¼ˆå·²å®ç°ï¼‰

## ğŸ”§ éƒ¨ç½²å’Œè¿ç»´è§„èŒƒ

### ç¯å¢ƒé…ç½®
```bash
# å¼€å‘ç¯å¢ƒ
NODE_ENV=development
VITE_SOCKET_URL=ws://localhost:3001

# ç”Ÿäº§ç¯å¢ƒ
NODE_ENV=production
VITE_SOCKET_URL=wss://your-domain.com
PORT=3001
CLIENT_URL=https://your-app.railway.app
```

### Railwayéƒ¨ç½²é…ç½®
```toml
[build]
command = "npm run build"

[deploy]
startCommand = "npm start"
healthcheckPath = "/health"
healthcheckTimeout = 300

[environments.production]
NODE_ENV = "production"
```

### æ„å»ºä¼˜åŒ–
- ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- èµ„æºå‹ç¼©å’Œä¼˜åŒ–
- CDN åŠ é€Ÿ
- ç¼“å­˜ç­–ç•¥

### ç›‘æ§å’Œæ—¥å¿—
- é”™è¯¯ç›‘æ§å’Œä¸ŠæŠ¥
- æ€§èƒ½ç›‘æ§
- ç”¨æˆ·è¡Œä¸ºåˆ†æ
- æœåŠ¡å™¨æ—¥å¿—ç®¡ç†

## ğŸ“š æ–‡æ¡£è§„èŒƒ

### ä»£ç æ³¨é‡Š
```typescript
/**
 * è¯†åˆ«å¡ç‰Œç±»å‹
 * @param cards - è¦è¯†åˆ«çš„å¡ç‰Œæ•°ç»„
 * @returns å¡ç‰Œç±»å‹ï¼Œå¦‚æœæ— æ³•è¯†åˆ«åˆ™è¿”å›null
 * @example
 * const type = identifyCardType([card1, card2]);
 */
export const identifyCardType = (cards: Card[]): CardType | null => {
  // å®ç°é€»è¾‘
};
```

### æ–‡æ¡£æ›´æ–°
- æ¯æ¬¡é‡å¤§åŠŸèƒ½æ›´æ–°å¿…é¡»æ›´æ–°æ–‡æ¡£
- ä½¿ç”¨ Markdown æ ¼å¼
- åŒ…å«ç¤ºä¾‹å’Œæˆªå›¾
- ç»´æŠ¤ API æ–‡æ¡£
- **ALWAYS** æ–°åŠŸèƒ½å®Œæˆåæ›´æ–° `README.md` çš„åŠŸèƒ½åˆ—è¡¨
- **ALWAYS** Bugä¿®å¤åæ›´æ–° `docs/BUGFIX_REPORT.md`
- **ALWAYS** UIæ”¹è¿›åæ›´æ–° `docs/gan_deng_yan_ui_ux_roadmap.md`
- **WHEN** æ·»åŠ æ–°ç‰Œå‹ â†’ **MUST** æ›´æ–° `docs/gan_deng_yan_rules.md`
- **ALWAYS** é˜¶æ®µæ€§å®Œæˆåæ›´æ–°å¯¹åº”çš„ `docs/PHASE*_ENHANCEMENTS.md`

## ğŸš€ æŒç»­æ”¹è¿›

### ä»£ç å®¡æŸ¥
- æ‰€æœ‰ä»£ç å¿…é¡»ç»è¿‡å®¡æŸ¥
- é‡ç‚¹å…³æ³¨æ€§èƒ½å’Œå®‰å…¨æ€§
- ç¡®ä¿ä»£ç å¯ç»´æŠ¤æ€§
- éµå¾ªæœ€ä½³å®è·µ

### æ€§èƒ½ç›‘æ§
- å®šæœŸè¿›è¡Œæ€§èƒ½æµ‹è¯•
- ç›‘æ§å…³é”®æŒ‡æ ‡
- ä¼˜åŒ–ç“¶é¢ˆç‚¹
- ç”¨æˆ·åé¦ˆæ”¶é›†

### æŠ€æœ¯å€ºåŠ¡ç®¡ç†
- å®šæœŸé‡æ„ä»£ç 
- æ›´æ–°ä¾èµ–ç‰ˆæœ¬
- ä¿®å¤å·²çŸ¥é—®é¢˜
- æ”¹è¿›æ¶æ„è®¾è®¡
- **ALWAYS** å®šæœŸæ£€æŸ¥ `docs/BUGFIX_REPORT.md` ä¸­çš„å·²çŸ¥é—®é¢˜
- **WHEN** å‘ç°ä»£ç é‡å¤ â†’ **MUST** è€ƒè™‘æå–å…¬å…±å‡½æ•°
- **ALWAYS** ä¿æŒå‰åç«¯ç±»å‹å®šä¹‰çš„ä¸€è‡´æ€§
- **ALWAYS** å®šæœŸæ›´æ–°ä¾èµ–åŒ…ç‰ˆæœ¬
- **WHEN** æ€§èƒ½é—®é¢˜å‡ºç° â†’ **MUST** ä¼˜å…ˆä¼˜åŒ–åŠ¨ç”»å’Œæ¸²æŸ“æ€§èƒ½

---

**æœ€åæ›´æ–°**: 2025å¹´7æœˆ
**ç»´æŠ¤è€…**: XWeaponX
**ç‰ˆæœ¬**: v1.0 