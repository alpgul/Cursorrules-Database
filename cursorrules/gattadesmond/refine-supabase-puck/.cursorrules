# Refine Framework Coding Rules

## ğŸ¯ NguyÃªn táº¯c chung
**LUÃ”N Æ¯U TIÃŠN Sá»¬ Dá»¤NG REFINE COMPONENTS VÃ€ HOOKS TRÆ¯á»šC KHI DÃ™NG CÃC THÆ¯ VIá»†N KHÃC**

Dá»± Ã¡n nÃ y sá»­ dá»¥ng Refine framework vá»›i Ant Design UI. Táº¥t cáº£ code pháº£i tuÃ¢n thá»§ cÃ¡c quy táº¯c sau:

---

## ğŸ“¦ Navigation & Routing

### âŒ KHÃ”NG BAO GIá»œ:
```tsx
import { useRouter } from "next/navigation";
router.push("/path");
```

### âœ… PHáº¢I DÃ™NG:
```tsx
import { useNavigation } from "@refinedev/core";

const { create, edit, list, show } = useNavigation();
create("landing_pages");        // Navigate to create page
edit("landing_pages", "123");    // Navigate to edit page
list("landing_pages");           // Navigate to list page
show("landing_pages", "123");    // Navigate to show page
```

### âœ… Cho Links:
```tsx
import { useLink } from "@refinedev/core";

const LinkTo = useLink();
<LinkTo to="/landing-pages">Landing Pages</LinkTo>
```

---

## ğŸ“ Forms

### âŒ KHÃ”NG BAO GIá»œ:
```tsx
import { Form } from "antd";
const [form] = Form.useForm();
```

### âœ… PHáº¢I DÃ™NG:
```tsx
import { useForm } from "@refinedev/antd";

const { formProps, saveButtonProps, onFinish } = useForm({
  resource: "landing_pages",
});

<Form {...formProps} onFinish={onFinish}>
  {/* form fields */}
</Form>
```

---

## ğŸ“Š Lists & Tables

### âŒ KHÃ”NG BAO GIá»œ:
```tsx
const [data, setData] = useState([]);
useEffect(() => {
  // fetch data manually
}, []);
```

### âœ… PHáº¢I DÃ™NG:
```tsx
import { useTable } from "@refinedev/antd";

const { tableProps } = useTable({
  resource: "landing_pages",
  syncWithLocation: true,
});
```

---

## ğŸ¨ CRUD Pages

### âŒ KHÃ”NG BAO GIá»œ:
```tsx
// Custom page structure
export default function CreatePage() {
  return <div>...</div>;
}
```

### âœ… PHáº¢I DÃ™NG:
```tsx
import { Create, Edit, List, Show } from "@refinedev/antd";

// Create Page
export default function LandingPageCreate() {
  const { formProps, saveButtonProps } = useForm({
    resource: "landing_pages",
  });
  
  return (
    <Create saveButtonProps={saveButtonProps}>
      <Form {...formProps}>
        {/* form fields */}
      </Form>
    </Create>
  );
}

// Edit Page
export default function LandingPageEdit() {
  const { formProps, saveButtonProps } = useForm({
    resource: "landing_pages",
  });
  
  return (
    <Edit saveButtonProps={saveButtonProps}>
      <Form {...formProps}>
        {/* form fields */}
      </Form>
    </Edit>
  );
}

// List Page
export default function LandingPageList() {
  const { tableProps } = useTable({
    resource: "landing_pages",
  });
  
  return (
    <List>
      <Table {...tableProps} />
    </List>
  );
}
```

---

## ğŸ”˜ Action Buttons

### âŒ KHÃ”NG BAO GIá»œ:
```tsx
<Button onClick={() => router.push(`/edit/${id}`)}>Edit</Button>
<Button onClick={() => deleteItem(id)}>Delete</Button>
```

### âœ… PHáº¢I DÃ™NG:
```tsx
import { EditButton, DeleteButton, ShowButton } from "@refinedev/antd";

<EditButton recordItemId={record.id} />
<DeleteButton recordItemId={record.id} />
<ShowButton recordItemId={record.id} />
```

---

## ğŸ” Data Fetching

### âŒ KHÃ”NG BAO GIá»œ:
```tsx
const [data, setData] = useState(null);
useEffect(() => {
  fetch("/api/data").then(res => res.json()).then(setData);
}, []);
```

### âœ… PHáº¢I DÃ™NG:
```tsx
import { useList, useShow, useCreate, useUpdate, useDelete } from "@refinedev/core";

// List data
const { data, isLoading } = useList({
  resource: "landing_pages",
});

// Show single record
const { data, isLoading } = useShow({
  resource: "landing_pages",
  id: "123",
});

// Create
const { mutate: create } = useCreate();
create({ resource: "landing_pages", values: { title: "New" } });

// Update
const { mutate: update } = useUpdate();
update({ resource: "landing_pages", id: "123", values: { title: "Updated" } });

// Delete
const { mutate: delete } = useDelete();
delete({ resource: "landing_pages", id: "123" });
```

---

## ğŸ” Authentication

### âŒ KHÃ”NG BAO GIá»œ:
```tsx
// Direct Supabase calls for auth
const { data: { user } } = await supabase.auth.getUser();
```

### âœ… PHáº¢I DÃ™NG:
```tsx
import { useGetIdentity, useLogout } from "@refinedev/core";

const { data: user } = useGetIdentity();
const { mutate: logout } = useLogout();
```

---

## ğŸ¯ Resource Configuration

**LUÃ”N Äáº¢M Báº¢O RESOURCE ÄÆ¯á»¢C Äá»ŠNH NGHÄ¨A TRONG `src/app/layout.tsx`:**

```tsx
<Refine
  resources={[
    {
      name: "landing_pages",
      list: "/landing-pages",
      create: "/landing-pages/create",
      edit: "/landing-pages/edit/:id",
      meta: {
        icon: <GlobalOutlined />,
        canDelete: true,
      },
    },
  ]}
>
```

---

## ğŸ“š Import Paths

### âœ… ÄÃºng:
```tsx
// Refine Core
import { useNavigation, useList, useShow } from "@refinedev/core";

// Refine Ant Design
import { useForm, useTable, Create, Edit, List } from "@refinedev/antd";
import { EditButton, DeleteButton } from "@refinedev/antd";

// Ant Design (chá»‰ dÃ¹ng cho UI components)
import { Button, Form, Input, Table } from "antd";
```

### âŒ Sai:
```tsx
// KHÃ”NG import Next.js router cho navigation
import { useRouter } from "next/navigation";
```

---

## âš ï¸ LÆ°u Ã½ Ä‘áº·c biá»‡t

1. **KHÃ”NG BAO GIá»œ** sá»­ dá»¥ng `useRouter` tá»« Next.js cho navigation trong components
2. **LUÃ”N** sá»­ dá»¥ng `useNavigation` tá»« `@refinedev/core` cho táº¥t cáº£ navigation
3. **LUÃ”N** sá»­ dá»¥ng `useForm`, `useTable` tá»« Refine thay vÃ¬ tá»± quáº£n lÃ½ state
4. **LUÃ”N** wrap CRUD pages trong `Create`, `Edit`, `List`, `Show` components
5. **LUÃ”N** sá»­ dá»¥ng Refine buttons (`EditButton`, `DeleteButton`) thay vÃ¬ custom buttons
6. **LUÃ”N** sá»­ dá»¥ng Refine hooks (`useList`, `useShow`, `useCreate`, etc.) cho data operations

---

## ğŸ” Checklist trÆ°á»›c khi commit

- [ ] ÄÃ£ thay tháº¿ táº¥t cáº£ `useRouter` báº±ng `useNavigation`
- [ ] ÄÃ£ sá»­ dá»¥ng `useForm` cho táº¥t cáº£ forms
- [ ] ÄÃ£ sá»­ dá»¥ng `useTable` cho táº¥t cáº£ lists/tables
- [ ] ÄÃ£ wrap CRUD pages trong Refine components (`Create`, `Edit`, `List`, `Show`)
- [ ] ÄÃ£ sá»­ dá»¥ng Refine buttons (`EditButton`, `DeleteButton`, `ShowButton`)
- [ ] ÄÃ£ sá»­ dá»¥ng Refine hooks cho data operations
- [ ] Resource Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong `layout.tsx`
- [ ] KhÃ´ng cÃ³ direct Supabase calls cho auth (dÃ¹ng `useGetIdentity`)

---

## ğŸ“– TÃ i liá»‡u tham kháº£o

- Refine Core: https://refine.dev/docs/core/
- Refine Ant Design: https://refine.dev/docs/ui-frameworks/antd/
- Refine Navigation: https://refine.dev/docs/routing/hooks/use-navigation/
- Refine Data Hooks: https://refine.dev/docs/data/hooks/use-list/

